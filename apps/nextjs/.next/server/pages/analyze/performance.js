"use strict";(()=>{var e={};e.id=9949,e.ids=[9949,2888,660],e.modules={801:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>f,default:()=>x,getServerSideProps:()=>h,getStaticPaths:()=>m,getStaticProps:()=>u,reportWebVitals:()=>g,routeModule:()=>_,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>v});var r=a(8877),l=a(4591),i=a(6021),c=a(1938),n=a.n(c),d=a(4801),o=a(3895),p=e([d,o]);[d,o]=p.then?(await p)():p;let x=(0,i.l)(o,"default"),u=(0,i.l)(o,"getStaticProps"),m=(0,i.l)(o,"getStaticPaths"),h=(0,i.l)(o,"getServerSideProps"),f=(0,i.l)(o,"config"),g=(0,i.l)(o,"reportWebVitals"),v=(0,i.l)(o,"unstable_getStaticProps"),j=(0,i.l)(o,"unstable_getStaticPaths"),y=(0,i.l)(o,"unstable_getStaticParams"),w=(0,i.l)(o,"unstable_getServerProps"),b=(0,i.l)(o,"unstable_getServerSideProps"),_=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/analyze/performance",pathname:"/analyze/performance",bundlePath:"",filename:""},components:{App:d.default,Document:n()},userland:o});s()}catch(e){s(e)}})},2085:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),l=a(6704),i=a(503),c=a(3411),n=a(8293),d=a(6391),o=a(1267),p=a(2428),x=a(8590),u=a(4830),m=e([l,n,d,o,p,x,u]);[l,n,d,o,p,x,u]=m.then?(await m)():m;let LegendItem=({label:e,color:t})=>(0,r.jsxs)("div",{className:"flex gap-1.5",children:[r.jsx("div",{className:"mt-1.5 h-1 w-5 rounded-full",style:{backgroundColor:t}}),r.jsx("p",{className:"text-[10px] text-gray/600",children:e})]}),StagesBars=({label:e,value:t,color:a,isLast:s})=>r.jsx(u.pn,{children:(0,r.jsxs)(u.u,{children:[r.jsx(u.aJ,{asChild:!0,children:r.jsx("div",{className:(0,n.cn)("h-full cursor-pointer",s&&"rounded-r-full"),style:{width:`${Math.abs(t)}%`,backgroundColor:a}})}),(0,r.jsxs)(u._v,{className:"border-none bg-gray/900 text-xs text-white",children:[r.jsx(l.Arrow,{}),(0,r.jsxs)("p",{children:[e,": ",(0,c.N)(t,1,!0),"%"]})]})]})}),__WEBPACK_DEFAULT_EXPORT__=({title:e,data:t,showStages:a})=>{let s=(0,i.useTranslations)();return(0,r.jsxs)(d.Zb,{className:"h-full p-4",children:[r.jsx(o.Z,{children:e}),r.jsx(x.Z,{className:"mb-5 mt-3 border-dashed border-gray-300"}),a?(0,r.jsxs)(r.Fragment,{children:[r.jsx(p.x,{className:"h-[240px] lg:h-[calc(100%_-_120px)]",children:r.jsx("div",{className:"flex flex-col gap-y-4",children:t.map((e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-2 flex justify-between text-sm",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[t+1," | ",e.name]}),(0,r.jsxs)("p",{className:"text-gray/400",children:[(0,c.N)(e.totalValue,1,!0),"%"]})]}),(0,r.jsxs)("div",{className:"relative flex h-1 w-full overflow-hidden rounded-full bg-gray/100",children:[r.jsx(StagesBars,{label:s("performancePerKpi.viewStages.step1Title"),value:e.upstream,color:"#c684ff"}),r.jsx(StagesBars,{label:s("performancePerKpi.viewStages.step2Title"),value:e.transportation,color:"#8e33ff"}),r.jsx(StagesBars,{label:s("performancePerKpi.viewStages.step3Title"),value:e.core,color:"#5119b7",isLast:!0})]})]},t))})}),(0,r.jsxs)(p.x,{children:[(0,r.jsxs)("div",{className:"mt-4 flex h-12 items-center justify-between gap-3 rounded-md border border-dashed border-gray/300 px-2",children:[r.jsx(LegendItem,{label:s("performancePerKpi.viewStages.step1Title"),color:"#c684ff"}),r.jsx(LegendItem,{label:s("performancePerKpi.viewStages.step2Title"),color:"#8e33ff"}),r.jsx(LegendItem,{label:s("performancePerKpi.viewStages.step3Title"),color:"#5119b7"})]}),r.jsx(p.B,{orientation:"horizontal"})]})]}):r.jsx(p.x,{className:"h-[calc(100%_-_55px)]",children:r.jsx("div",{className:"flex flex-col gap-y-4",children:t.map((e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-2 flex justify-between text-sm",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[t+1," | ",e.name]}),(0,r.jsxs)("p",{className:"text-gray/400",children:[(0,c.N)(e.value,1,!0),"%"]})]}),r.jsx("div",{className:"h-[3px] w-full rounded-full bg-secondary/lighter",children:r.jsx("div",{className:"h-full rounded-full bg-secondary",style:{width:`${e.value}%`}})})]},t))})})]})};s()}catch(e){s(e)}})},8731:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),l=a(6577),i=a.n(l),c=a(503),n=a(8293),d=a(6391),o=e([n,d]);[n,d]=o.then?(await o)():o;let __WEBPACK_DEFAULT_EXPORT__=({category:e})=>{let t=(0,c.useTranslations)();return(0,r.jsxs)(d.Zb,{className:"flex w-auto gap-2 bg-gray/100 p-2 shadow-none",children:[r.jsx("div",{className:"w-10",children:r.jsx(i(),{alt:e,src:{ClimateChange:"/images/sustainable-goals/climate-change.png",EcosystemQuality:"/images/sustainable-goals/ecosystem-quality.png",HumanHealth:"/images/sustainable-goals/human-health.png",ResourcesExhaustion:"/images/sustainable-goals/resources-exhaustion.png"}[e],height:50,width:50,className:"rounded-[2px]"})}),(0,r.jsxs)("div",{className:"w-fit",children:[r.jsx("h3",{className:(0,n.cn)("mb-[1px] text-[11px] font-semibold leading-3 2xl:text-xs",{ClimateChange:"text-[#118D57]",EcosystemQuality:"text-[#006C9C]",HumanHealth:"text-[#00A76F]",ResourcesExhaustion:"text-[#B76E00]"}[e]),children:t(`sustainableGoals.title.${e}`)}),(0,r.jsxs)("p",{className:"text-[10px] leading-[14px] text-gray/600 2xl:text-xs",children:[t(`sustainableGoals.description.${e}`),r.jsx("a",{href:{ClimateChange:"https://www.un.org/sustainabledevelopment/es/climate-change-2/",EcosystemQuality:"https://www.un.org/sustainabledevelopment/es/oceans/",HumanHealth:"https://www.un.org/sustainabledevelopment/es/health/",ResourcesExhaustion:"https://www.un.org/sustainabledevelopment/es/sustainable-consumption-production/"}[e],target:"_blank",className:"ml-1 underline",children:t("text.seeMore")})]})]})]})};s()}catch(e){s(e)}})},7113:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997);a(6689);var l=a(3767),i=a(723),c=a.n(i),n=a(738),d=a(261),o=a(3411),p=e([l,n]);[l,n]=p.then?(await p)():p,l.Chart.register(l.RadialLinearScale,l.ArcElement,c());let createLinearGradient=(e,t,a)=>{if(!e.chart.chartArea)return;let s=e.chart.ctx,r=e.chart.chartArea.top,l=e.chart.chartArea.bottom,i=e.chart.chartArea.left,c=e.chart.chartArea.right,n=s.createLinearGradient(r,i,l,c);return n.addColorStop(0,t),n.addColorStop(1,a),n},__WEBPACK_DEFAULT_EXPORT__=({chartData:e,selectedActivities:t})=>r.jsx(n.Doughnut,{data:e,options:{parsing:{key:"value"},maintainAspectRatio:!1,layout:{padding:{top:30,bottom:30,right:145,left:145}},cutout:"60%",events:[],elements:{arc:{backgroundColor:function(e){let a=e.dataset.data[e.dataIndex];return!(0,d.VL)(a.id,t)&&t.length>0?"#DFE3E8":0===e.dataIndex?createLinearGradient(e,"#FFAB00","#B76E00"):1===e.dataIndex?createLinearGradient(e,"#b76e0099","#ffab0099"):createLinearGradient(e,"#ffab003d","#b76e003d")},hoverBorderColor:"#ffffff",borderWidth:2}},plugins:{tooltip:{enabled:!1},legend:{display:!1},datalabels:{padding:{top:4,bottom:2},anchor:"end",align:"end",offset:10,font:{family:"Poppins"},display:e=>{let a=e.dataIndex,s=e.dataset.data,r=s[a]?.id??"";return!!(0,d.VL)(r,t)||"auto"},borderRadius:4,color:e=>{let a=e.dataIndex,s=e.dataset.data,r=s[a]?.id??"";return!(0,d.VL)(r,t)&&t.length>0?"#DFE3E8ba":0===e.dataIndex||1===e.dataIndex?"white":"black"},backgroundColor:e=>{let a=e.chart.ctx,s=a.createLinearGradient(-10,-10,20,50),r=e.dataIndex,l=e.dataset.data,i=l[r]?.id??"";return!(0,d.VL)(i,t)&&t.length>0?"#DFE3E850":(0===r?(s.addColorStop(0,"#FFAB00"),s.addColorStop(1,"#B76E00")):1===r?(s.addColorStop(0,"#ffab0099"),s.addColorStop(1,"#b76e0099")):(s.addColorStop(0,"#ffab003d"),s.addColorStop(1,"#b76e003d")),s)},formatter:function(e,t){return`${t?.chart?.data?.labels?.[t.dataIndex]}: ${(0,o.N)(parseFloat(e.value),1,!0)}%`}}}}});s()}catch(e){s(e)}})},6299:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),l=a(6689),i=a(307),c=a(503),n=a(857),d=a(9276),o=a(6391),p=a(2428),x=a(7936),u=a(8590),m=e([i,d,o,p,x,u]);[i,d,o,p,x,u]=m.then?(await m)():m;let __WEBPACK_DEFAULT_EXPORT__=({products:e,selectedProduct:t,setSelectedProduct:a,kpis:s,selectedKpiIds:m,setSelectedKpiIds:h,activities:f,selectedActivities:g,setSelectedActivities:v,disableActivityFilter:j,multiselect:y})=>{let w=(0,c.useTranslations)(),b=(0,c.useLocale)(),onKpiClick=e=>{if(!y){h(e);return}let t=m.find(t=>t===e);if(t){let t=m.indexOf(e),a=[...m.slice(0,t),...m.slice(t+1)];h(a);return}let a=[...m,e];h(a)},onActivityClick=e=>{let t=g.find(t=>t===e);if(t){let t=g.indexOf(e),a=[...g.slice(0,t),...g.slice(t+1)];v(a);return}let a=[...g,e];if(a.length===f.length)return v([]);v(a)};return(0,l.useEffect)(()=>{j&&v([])},[m]),(0,r.jsxs)(o.Zb,{className:"px-4 py-3",children:[r.jsx("p",{className:"text-sm font-semibold text-gray/700",children:w("filters.title")}),(0,r.jsxs)("div",{className:"flex w-full items-center py-2",children:[(0,r.jsxs)(x.Ph,{onValueChange:e=>a(e),value:t,children:[r.jsx(x.i4,{className:"h-7 w-[360px] border-secondary/light font-secondary text-xs font-semibold text-secondary/light",children:r.jsx(x.ki,{placeholder:w("performancePerKpi.viewPanel.selectAProduct")})}),r.jsx(x.Bw,{children:e.map(e=>r.jsx(x.Ql,{value:e.id,children:(0,n.i)(e.name,b)},e.id))})]}),r.jsx("div",{className:"mx-4 h-9 border-r border-dashed border-gray/400"}),(0,r.jsxs)(i.ScrollArea,{className:"w-full overflow-auto whitespace-nowrap",children:[r.jsx("div",{className:"flex gap-x-4",children:s.map(e=>r.jsx(d.z,{className:"h-auto w-full px-1 py-[5px] text-xs",variant:!y&&m===e.id||y&&m?.some(t=>t===e.id)?"secondary-outline":"inactive-outline",onClick:()=>onKpiClick(e.id),children:(0,n.i)(e.name,b)},e.id))}),r.jsx(p.B,{orientation:"horizontal"})]})]}),r.jsx(u.Z,{className:"border-dashed border-gray-300"}),(0,r.jsxs)(i.ScrollArea,{className:"w-full overflow-auto whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"flex w-full items-center gap-x-4 pt-3",children:[r.jsx(d.z,{className:"h-auto w-full px-1 py-[5px] text-xs",variant:0===g.length?"secondary-outline":"inactive-outline",onClick:()=>v([]),disabled:j,children:w("filters.activity.viewAll")},"ViewAll"),f.map(e=>r.jsx(d.z,{className:"h-auto w-full px-1 py-[5px] text-xs",variant:g?.some(t=>e===t)?"secondary-outline":"inactive-outline",onClick:()=>onActivityClick(e),disabled:j,children:w(`filters.activity.${e}`)},e))]}),r.jsx(p.B,{orientation:"horizontal"})]})]})};s()}catch(e){s(e)}})},7104:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),l=a(503),i=a(3988),c=a(261),n=a(6391),d=a(1267),o=a(8590),p=a(6068),x=a(2085),u=a(486),m=a(8731),h=a(3230),f=a(8646),g=a(7113),v=a(6299),j=a(6096),y=e([n,d,o,p,x,u,m,h,f,g,v,j]);[n,d,o,p,x,u,m,h,f,g,v,j]=y.then?(await y)():y;let Shimmer=()=>(0,r.jsxs)("div",{className:"h-full w-full",children:[(0,r.jsxs)(n.Zb,{className:"h-[137px] w-full px-4 py-3",children:[r.jsx(p.O,{className:"mb-2 h-7 w-[150px]"}),(0,r.jsxs)("div",{className:"flex gap-6",children:[r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"})]}),r.jsx(o.Z,{className:"m-2 border-dashed border-gray-300"}),(0,r.jsxs)("div",{className:"flex gap-6",children:[r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex h-full flex-col gap-4 lg:flex-row",children:[(0,r.jsxs)(n.Zb,{className:"w-full p-3 lg:w-2/3",children:[r.jsx(p.O,{className:"h-11 w-[150px]"}),r.jsx(o.Z,{className:"m-1 border-dashed border-gray-300"}),(0,r.jsxs)("div",{className:"flex h-[calc(100%_-_50px)] flex-col justify-between lg:flex-row",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col justify-between",children:[r.jsx(p.O,{className:"h-[116px] w-full"}),r.jsx("div",{className:"hidden w-full lg:flex",children:r.jsx(p.O,{className:"h-[65px] w-full"})})]}),r.jsx("div",{className:"flex h-fit min-h-[300px] w-full items-center justify-center lg:h-[calc(100vh_-_435px)] lg:max-w-[75%]",children:r.jsx(i.Cd,{size:120,className:"animate-spin text-gray/200"})}),r.jsx("div",{className:"mt-7 w-[250px] lg:hidden",children:r.jsx(p.O,{className:"h-[65px]"})})]})]}),(0,r.jsxs)(n.Zb,{className:"flex h-[500px] min-h-[380px] flex-col gap-4 p-4 lg:h-[calc(100vh_-_358px)] lg:w-1/3",children:[r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(p.O,{className:"h-10 w-full"})]})]})]}),__WEBPACK_DEFAULT_EXPORT__=({category:e,selectedProductId:t,setSelectedProductId:a})=>{let s=(0,l.useTranslations)(),{pageData:i,allActivities:p,electricityDataCard:y,productsAndKpisList:w,isLoading:b,selectedActivities:_,setSelectedActivities:N,selectedKpiId:P,setSelectedKpiId:S,kpisListFilter:C,selectedKpi:E,listCardData:K,doughnutChartData:A,monitorCardValues:k,barChartData:L}=(0,j.Z)({category:e,selectedProductId:t,setSelectedProductId:a});if(b||!w||!i)return r.jsx(Shimmer,{});if(0===w.productsList.length)return r.jsx("div",{className:"h-[calc(100vh_-_260px)] lg:h-[calc(100vh_-_210px)]",children:r.jsx(h.Z,{})});let Z=E?.key==="UseOfElectricity"||E?.key==="WaterFootprint";return(0,r.jsxs)(r.Fragment,{children:[r.jsx(v.Z,{products:w?.productsList,selectedProduct:t,setSelectedProduct:a,kpis:C,selectedKpiIds:P,setSelectedKpiIds:S,activities:p,selectedActivities:_,setSelectedActivities:N,disableActivityFilter:Z,multiselect:!1}),(0,r.jsxs)("div",{className:"mt-4 flex h-full flex-col gap-4 lg:flex-row",children:[(0,r.jsxs)(n.Zb,{className:"w-full p-2 lg:min-w-[50%] lg:max-w-[70%]",children:[r.jsx(d.Z,{className:"ml-2 py-2",children:s("performancePerKpi.viewPanel.title")}),r.jsx(o.Z,{className:"m-1 border-dashed border-gray-300"}),(0,r.jsxs)("div",{className:"flex h-[calc(100%_-_50px)] flex-col justify-between xl:flex-row",children:[(0,r.jsxs)("div",{className:"flex w-[30%] flex-col justify-between",children:[r.jsx("div",{children:k().map((e,t)=>r.jsx(u.Z,{className:"h-fit p-2",title:e.title,amount:e.amount,unit:e.unit,enableFooter:!!e.variation,variation:e.variation,isCard:!1},t))}),r.jsx("div",{className:"hidden xl:flex",children:r.jsx(m.Z,{category:e})})]}),r.jsx("div",{className:"flex h-fit w-full items-center xl:h-full xl:max-w-[70%]",children:r.jsx("div",{className:"min-h-[300px] w-full xl:h-[calc(100vh_-_435px)]",children:r.jsx(g.Z,{chartData:A,selectedActivities:_})})}),r.jsx("div",{className:"mt-7 w-[250px] xl:hidden",children:r.jsx(m.Z,{category:e})})]})]}),E?.key!=="WaterFootprint"?r.jsx("div",{className:"h-fit lg:h-[600px] lg:min-w-[30%] xl:h-[calc(100vh_-_358px)] xl:min-h-[365px]",children:y?r.jsx(x.Z,{title:s("performancePerKpi.viewPanel.generationSources"),data:y,showStages:!1}):r.jsx(x.Z,{title:s("performancePerKpi.viewPanel.inputContribution"),data:K,showStages:!0})}):(0,r.jsxs)(n.Zb,{className:"min-w-[40%] p-2",children:[(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx(d.Z,{children:s("performancePerKpi.viewPanel.hydricBalance")}),(0,r.jsxs)("p",{className:"text-[11px] text-gray/500",children:[s("performancePerKpi.viewPanel.inmm"),"."," ",s("performancePerKpi.viewPanel.campaign",{startDate:(0,c.UW)(i.organizationCampaign.startDate,s),endDate:(0,c.UW)(i.organizationCampaign.endDate,s)})]})]}),r.jsx(o.Z,{className:"m-1 border-dashed border-gray-300"}),r.jsx("div",{className:"min-h-[300px] lg:h-[calc(100%_-_50px)]",children:L&&r.jsx(f.Z,{chartData:L,barWidth:30,labelsSize:10})})]})]})]})};s()}catch(e){s(e)}})},5711:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),l=a(503),i=a(5186),c=a(9362),n=a(6391),d=a(1267),o=a(8590),p=a(6068),x=a(3230),u=a(8646),m=a(6299),h=a(2548),f=e([n,d,o,p,x,u,m,h]);[n,d,o,p,x,u,m,h]=f.then?(await f)():f;let ShimmerCardComponent=()=>(0,r.jsxs)(n.Zb,{className:"w-full p-4 lg:w-1/3",children:[r.jsx(p.O,{className:"h-10 w-full"}),r.jsx(o.Z,{className:"m-1 border-dashed border-gray-300"}),r.jsx("div",{className:"mt-2 h-[350px] w-full lg:h-[calc(100vh_-_440px)] lg:min-h-[260px]",children:r.jsx(p.O,{className:"h-full w-full"})})]}),Shimmer=()=>(0,r.jsxs)("div",{className:"h-full w-full",children:[(0,r.jsxs)(n.Zb,{className:"h-[137px] w-full px-4 py-3",children:[r.jsx(p.O,{className:"mb-2 h-7 w-[150px]"}),(0,r.jsxs)("div",{className:"flex gap-6",children:[r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"})]}),r.jsx(o.Z,{className:"m-2 border-dashed border-gray-300"}),(0,r.jsxs)("div",{className:"flex gap-6",children:[r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"}),r.jsx(p.O,{className:"h-7 w-full"})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-4 lg:flex-row",children:[r.jsx(ShimmerCardComponent,{}),r.jsx(ShimmerCardComponent,{}),r.jsx(ShimmerCardComponent,{})]})]}),CardComponent=({title:e,barChartData:t,showArrows:a=!0,kpisSelected:s})=>{let c=(0,l.useTranslations)();return(0,r.jsxs)(n.Zb,{className:"w-full overflow-hidden p-4 lg:w-1/3",children:[(0,r.jsxs)("div",{className:"flex w-full justify-between",children:[(0,r.jsxs)("div",{className:"flex w-[70%] flex-col",children:[r.jsx(d.Z,{className:"truncate",children:e}),r.jsx("p",{className:"truncate text-[11px] text-gray/500",children:c("performancePerKpi.viewStages.chartSubTitle")})]}),a&&(0,r.jsxs)("div",{className:"flex items-center justify-center ",children:[r.jsx(i.Djl,{className:"relative left-6 text-secondary",size:30}),r.jsx(i.Djl,{className:"relative left-3 text-secondary",size:30}),r.jsx(i.Djl,{className:"relative text-secondary",size:30})]})]}),r.jsx(o.Z,{className:"m-1 border-dashed border-gray-300"}),r.jsx("div",{className:"mt-2 h-[350px] w-full lg:h-[calc(100vh_-_440px)] lg:min-h-[260px]",children:s?r.jsx(u.Z,{maxYValue:100,labelsSize:9,barWidth:30,chartData:t,unit:"%"}):r.jsx("div",{className:"flex h-full w-full items-center justify-center rounded-lg border border-gray/200 bg-gray/100",children:r.jsx("p",{className:"text-sm text-gray/500",children:c("performancePerKpi.viewStages.pleaseSelectKpi")})})})]})},__WEBPACK_DEFAULT_EXPORT__=({category:e,selectedProductId:t,setSelectedProductId:a})=>{let s=(0,l.useTranslations)(),{pageData:i,productsAndKpisList:n,isLoading:d,selectedActivities:o,setSelectedActivities:p,selectedKpiIds:u,setSelectedKpiIds:f,stage1barChartData:g,stage2barChartData:v,stage3barChartData:j}=(0,h.Z)({category:e,selectedProductId:t,setSelectedProductId:a});return!d&&n&&i?0===n.productsList.length?r.jsx("div",{className:"h-[calc(100vh_-_260px)] lg:h-[calc(100vh_-_210px)]",children:r.jsx(x.Z,{})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(m.Z,{products:n.productsList,selectedProduct:t,setSelectedProduct:a,kpis:n.kpisList,selectedKpiIds:u,setSelectedKpiIds:f,activities:c.H,selectedActivities:o,setSelectedActivities:p,multiselect:!0}),(0,r.jsxs)("div",{className:"mt-4 flex w-full flex-col gap-4 lg:flex-row",children:[r.jsx(CardComponent,{title:s("performancePerKpi.viewStages.step1Title"),barChartData:g,kpisSelected:0!==u.length},`stage-1-${u.length}`),r.jsx(CardComponent,{title:s("performancePerKpi.viewStages.step2Title"),barChartData:v,kpisSelected:0!==u.length},`stage-2-${u.length}`),r.jsx(CardComponent,{title:s("performancePerKpi.viewStages.step3Title"),barChartData:j,showArrows:!1,kpisSelected:0!==u.length},`stage-3-${u.length}`)]})]}):r.jsx(Shimmer,{})};s()}catch(e){s(e)}})},6096:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(6689),l=a(503),i=a(4271),c=a(9362),n=a(857),d=a(261),o=a(3411),p=e([i]);i=(p.then?(await p)():p)[0];let __WEBPACK_DEFAULT_EXPORT__=({category:e,selectedProductId:t,setSelectedProductId:a})=>{let s=(0,l.useTranslations)(),p=(0,l.useLocale)(),[x,u]=(0,r.useState)(),[m,h]=(0,r.useState)([]),{data:f,isLoading:g}=i.h.analyze.productsAndKpisList.useQuery({category:e}),v=f?.kpisList.filter(e=>"WaterProductivity"!==e.key)??[];(0,r.useEffect)(()=>{f&&(t||a(f.productsList[0]?.id),x||u(v?.[0]?.id))},[f]);let{data:j,isLoading:y}=i.h.analyze.performancePanel.useQuery({category:e,kpiIdFilter:x,productIdFilter:t}),w=f?.kpisList.find(e=>e.id===x),{data:b}=i.h.analyze.electricity.useQuery({kpiIdFilter:x,productIdFilter:t},{enabled:w?.key==="UseOfElectricity"}),{data:_}=i.h.analyze.waterComposition.useQuery({kpiIdFilter:x,productIdFilter:t},{enabled:w?.key==="WaterFootprint"}),N=j?.benchmark,P=j?.selectedProductAmount??0,S=w?.unit??"",C=j?.totalKpi??0,E=m.length>0?m:j?.activitiesList??[],K=c.H.map(e=>{let t=j?.activityProductKpis.filter(t=>t.activity===e),a=t?.reduce((e,t)=>e+t.totalValue,0)??0;return{activity:e,totalValue:a}}),A=K&&K?.length>0?K?.reduce((e,t)=>E.find(e=>e===t.activity)?e+t.totalValue:e,0):C,k=K.reduce((e,t)=>e+Math.abs(t.totalValue),0),L=K?.reduce((e,t)=>E.find(e=>e===t.activity)?e+Math.abs(t.totalValue):e,0),Z=E.map(e=>{let t=j?.activityInputs.filter(t=>t.activity.activity===e)??[],a=[];t.forEach(e=>{a.some(t=>t.id===e.inputId)||a.push(e.input)});let s=a.map(e=>{let stagesKpi=a=>A?t.reduce((t,s)=>s.inputId===e.id?t+s[a]:t,0)/L*100:0;return{id:e.id,name:(0,n.i)(e.name,p),totalValue:stagesKpi("totalValue"),upstream:stagesKpi("upstream"),core:stagesKpi("core"),transportation:stagesKpi("transportation")}});return{activity:e,inputs:s}}),T=Z.map(e=>e.inputs).flat().filter(e=>0!==e.totalValue).sort((e,t)=>Math.abs(t.totalValue)-Math.abs(e.totalValue)),I=A/P,O=N&&((w&&(0,d.JU)(w.key)?A:I)-N)/N*100,chartData=()=>b?{data:b.classification.map(e=>({id:e.key,value:(0,o.N)(e.value)})),labels:b.classification.map(e=>s(`electricity.${e.key}`))}:_?{data:_.footprints.map(e=>({id:e.key,value:(0,o.N)(e.value)})),labels:_.footprints.map(e=>s(`waterFootprints.${e.key}`))}:{data:K?.sort((e,t)=>Math.abs(t.totalValue)-Math.abs(e.totalValue)).map(e=>({id:e.activity,value:o.N(Math.abs(e.totalValue/k*100))}))??[],labels:K?.sort((e,t)=>Math.abs(t.totalValue)-Math.abs(e.totalValue)).map(e=>s(`filters.activity.${e.activity}`))??[]},D={labels:chartData().labels,datasets:[{data:chartData().data}]},F=_&&{datasets:[{data:_?.barChartData.map(e=>({label:s(`waterComposition.${e.key}`).split("\n"),value:e.value}))}]},B=b?.electricitySources.map(e=>({name:n.i(e.name,p),value:e.value/C*100,id:e.id})).filter(e=>0!==e.value).sort((e,t)=>t.value-e.value);return{pageData:j,allActivities:c.H,electricityDataCard:B,productsAndKpisList:f,isLoading:y||g,selectedActivities:m,setSelectedActivities:h,selectedKpiId:x,setSelectedKpiId:u,kpisListFilter:v,selectedKpi:w,listCardData:T,doughnutChartData:D,monitorCardValues:()=>{let e={title:(0,n.i)(w?.name??[],p),amount:w&&(0,d.JU)(w.key)?A:I,unit:`${S} ${w&&(0,d.JU)(w.key)?"":" / ton"}`,variation:O},t=_?.waterProductivity,a=t?.benchmark,s=a&&((t?.value??0)-a)/a*100,r={title:(0,n.i)(t?.name??[],p),amount:t?.value??0,unit:`${t?.unit??""}`,variation:s};return w?.key==="WaterFootprint"?[e,r]:[e]},barChartData:F}};s()}catch(e){s(e)}})},2548:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(6689),l=a(503),i=a(4271),c=a(857),n=e([i]);i=(n.then?(await n)():n)[0];let __WEBPACK_DEFAULT_EXPORT__=({category:e,selectedProductId:t,setSelectedProductId:a})=>{let s=(0,l.useLocale)(),[n,d]=(0,r.useState)([]),[o,p]=(0,r.useState)([]),{data:x,isLoading:u}=i.h.analyze.productsAndKpisList.useQuery({category:e});(0,r.useEffect)(()=>{x&&(t||a(x.productsList[0]?.id),0===n.length&&d(x.kpisList.map(e=>e.id)))},[x]);let{data:m,isLoading:h}=i.h.analyze.performanceStages.useQuery({category:e,productIdFilter:t}),f=m?.activityProductKpisByKpi.map(e=>{let t=e.activityProductKpis.reduce((e,t)=>e+Math.abs(t.totalValue),0),stageKpi=t=>e.activityProductKpis.reduce((e,a)=>e+a.activityInputs.reduce((e,a)=>e+Math.abs(a[t]),0),0);return{kpiId:e.kpiId,upstream:stageKpi("upstream")/t*100,core:stageKpi("core")/t*100,transportation:stageKpi("transportation")/t*100}}),g=m?.activityProductKpisByKpi.map(e=>{let t=e.activityProductKpis.reduce((e,t)=>e+Math.abs(t.totalValue),0),stageKpi=t=>e.activityProductKpis.reduce((e,a)=>o.some(e=>e===a.activity)||0===o.length?e+a.activityInputs.reduce((e,a)=>e+Math.abs(a[t]),0):e,0);return{kpiId:e.kpiId,upstream:t>0?stageKpi("upstream")/t*100:0,core:t>0?stageKpi("core")/t*100:0,transportation:t>0?stageKpi("transportation")/t*100:0}}),v=x?.kpisList.map(e=>({id:e.id,name:n.length>2?c.i(e.name,s).split(/[\s-]+/):c.i(e.name,s)})),generateStageDataset=e=>({datasets:[{data:n.map(t=>({label:v?.find(e=>e.id===t)?.name??"",value:g?.find(e=>e.kpiId===t)?.[e]??0}))},{data:n.map(t=>({label:v?.find(e=>e.id===t)?.name??"",value:f?.find(e=>e.kpiId===t)?.[e]??0}))}]}),j=generateStageDataset("upstream"),y=generateStageDataset("transportation"),w=generateStageDataset("core");return{pageData:m,productsAndKpisList:x,isLoading:u||h,selectedActivities:o,setSelectedActivities:p,selectedKpiIds:n,setSelectedKpiIds:d,stage1barChartData:j,stage2barChartData:y,stage3barChartData:w}};s()}catch(e){s(e)}})},3895:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>m,getServerSideProps:()=>getServerSideProps});var r=a(997),l=a(6689),i=a(2948),c=a(6310),n=a(7989),d=a(7104),o=a(5711),p=a(6697),x=a(2836),u=e([c,n,d,o,p,x]);[c,n,d,o,p,x]=u.then?(await u)():u;let PerofrmancePage=()=>{let[e,t]=(0,l.useState)("climateChange"),[a,s]=(0,l.useState)("viewPanel"),[i,p]=(0,l.useState)();return r.jsx(n.Z,{switchTabs:r.jsx(c.Z,{key1:"viewPanel",key2:"viewStages",setSelected:s,defaultValue:"viewPanel"}),selectedTab:e,setSelectedTab:t,tabs:[{key:"climateChange",content:"viewPanel"===a?r.jsx(d.Z,{category:"ClimateChange",setSelectedProductId:p,selectedProductId:i}):r.jsx(o.Z,{category:"ClimateChange",setSelectedProductId:p,selectedProductId:i})},{key:"ecosystemQuality",content:"viewPanel"===a?r.jsx(d.Z,{category:"EcosystemQuality",setSelectedProductId:p,selectedProductId:i}):r.jsx(o.Z,{category:"EcosystemQuality",setSelectedProductId:p,selectedProductId:i})},{key:"humanHealth",content:"viewPanel"===a?r.jsx(d.Z,{category:"HumanHealth",setSelectedProductId:p,selectedProductId:i}):r.jsx(o.Z,{category:"HumanHealth",setSelectedProductId:p,selectedProductId:i})},{key:"resourcesExhaustion",content:"viewPanel"===a?r.jsx(d.Z,{category:"ResourcesExhaustion",setSelectedProductId:p,selectedProductId:i}):r.jsx(o.Z,{category:"ResourcesExhaustion",setSelectedProductId:p,selectedProductId:i})}]})};PerofrmancePage.getLayout=e=>r.jsx(p.Z,{titleKey:"performancePerKpi",children:e});let getServerSideProps=async e=>{let t=await (0,x.x)(e);return await Promise.all([t.analyze.productsAndKpisList.prefetch({category:"ClimateChange"}),t.analyze.productsAndKpisList.prefetch({category:"HumanHealth"}),t.analyze.productsAndKpisList.prefetch({category:"EcosystemQuality"}),t.analyze.productsAndKpisList.prefetch({category:"ResourcesExhaustion"})]),{props:{trpcState:t.dehydrate(),messages:await (0,i.E)(e.locale)}}},m=PerofrmancePage;s()}catch(e){s(e)}})},9362:(e,t,a)=>{a.d(t,{H:()=>s});let s=["Fertilizers","Agrochemicals","Machinery","Electricity","Soil","Other"]},1841:e=>{e.exports=require("@aws-sdk/client-s3")},4298:e=>{e.exports=require("@aws-sdk/client-ses")},3303:e=>{e.exports=require("@paralleldrive/cuid2")},3524:e=>{e.exports=require("@prisma/client")},7620:e=>{e.exports=require("@radix-ui/react-avatar")},3363:e=>{e.exports=require("@radix-ui/react-dialog")},8532:e=>{e.exports=require("@radix-ui/react-dropdown-menu")},4034:e=>{e.exports=require("@radix-ui/react-select")},2479:e=>{e.exports=require("@radix-ui/react-toast")},8432:e=>{e.exports=require("bcryptjs")},723:e=>{e.exports=require("chartjs-plugin-datalabels")},8103:e=>{e.exports=require("clsx")},9344:e=>{e.exports=require("jsonwebtoken")},3227:e=>{e.exports=require("next-auth")},7449:e=>{e.exports=require("next-auth/providers/credentials")},1649:e=>{e.exports=require("next-auth/react")},503:e=>{e.exports=require("next-intl")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},5184:e=>{e.exports=require("nodemailer")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},72:e=>{e.exports=require("superjson")},1656:e=>{e.exports=import("@hookform/resolvers/zod")},7412:e=>{e.exports=import("@radix-ui/react-accordion")},49:e=>{e.exports=import("@radix-ui/react-label")},307:e=>{e.exports=import("@radix-ui/react-scroll-area")},6860:e=>{e.exports=import("@radix-ui/react-tabs")},6704:e=>{e.exports=import("@radix-ui/react-tooltip")},7717:e=>{e.exports=import("@react-email/components")},846:e=>{e.exports=import("@react-email/font")},4116:e=>{e.exports=import("@react-email/head")},8816:e=>{e.exports=import("@react-email/render")},3594:e=>{e.exports=import("@t3-oss/env-core")},6206:e=>{e.exports=import("@t3-oss/env-nextjs")},272:e=>{e.exports=import("@trpc/client")},7455:e=>{e.exports=import("@trpc/next")},5468:e=>{e.exports=import("@trpc/react-query/server")},2937:e=>{e.exports=import("@trpc/server")},3767:e=>{e.exports=import("chart.js")},6926:e=>{e.exports=import("class-variance-authority")},738:e=>{e.exports=import("react-chartjs-2")},5641:e=>{e.exports=import("react-hook-form")},8097:e=>{e.exports=import("tailwind-merge")},9926:e=>{e.exports=import("zod")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[1938,8724,7457,5632,5487,9244,6983,3988,5186,4801,2876,1172,3833,2836,6391,7989,4830,5188,8646],()=>__webpack_exec__(801));module.exports=a})();