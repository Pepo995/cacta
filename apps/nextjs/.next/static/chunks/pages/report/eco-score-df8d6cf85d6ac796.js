(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12],{287:function(e,r,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/report/eco-score",function(){return l(7509)}])},6391:function(e,r,l){"use strict";l.d(r,{Zb:function(){return c}});var t=l(2322),s=l(2784),a=l(6229);let c=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-xxl bg-card text-card-foreground shadow-default",l),...s})});c.displayName="Card";let o=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",l),...s})});o.displayName="CardHeader";let n=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("text-lg font-semibold leading-none tracking-tight text-neutral-400",l),...s})});n.displayName="CardTitle";let i=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",l),...s})});i.displayName="CardDescription";let d=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("h-full p-6 pt-0",l),...s})});d.displayName="CardContent";let x=s.forwardRef((e,r)=>{let{className:l,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)(" flex items-center p-6 pt-0",l),...s})});x.displayName="CardFooter"},6405:function(e,r,l){"use strict";var t=l(2322),s=l(951),a=l(6391);r.Z=e=>{let{text:r}=e;return(0,t.jsxs)(a.Zb,{className:"flex items-center gap-x-4 rounded-xl border border-info_16 bg-info_8 p-2 px-4 shadow-none",children:[(0,t.jsx)(s.kA6,{className:"text-info",size:24}),(0,t.jsx)("p",{className:"whitespace-pre-line text-xs font-semibold text-info/dark",children:r})]})}},3230:function(e,r,l){"use strict";var t=l(2322),s=l(2174),a=l(951),c=l(6391);r.Z=()=>{let e=(0,s.useTranslations)();return(0,t.jsxs)(c.Zb,{className:"flex h-full flex-col items-center justify-center border border-info_16 bg-info_8 p-4 shadow-none",children:[(0,t.jsx)(a.kA6,{className:"mb-2 text-info",size:24}),(0,t.jsx)("p",{className:"whitespace-pre-line text-center text-sm font-semibold text-info/dark",children:e("uncompletedCampaign.title")})]})}},7509:function(e,r,l){"use strict";l.r(r),l.d(r,{__N_SSP:function(){return y},default:function(){return _}});var t=l(2322),s=l(2784),a=l(2174),c=l(7687),o=l(857),n=l(261),i=l(6391),d=l(1267),x=l(7936),u=l(8590),p=l(6068),m=l(6405),h=l(3230),g=l(5819),f=l(6229),j=l(2428);let b=[{letter:"E",lowerBound:null,upperBound:15},{letter:"D",lowerBound:15,upperBound:40},{letter:"C",lowerBound:40,upperBound:70},{letter:"B",lowerBound:70,upperBound:90},{letter:"A",lowerBound:90,upperBound:null}],N={A:"bg-success/light",B:"bg-success",C:"bg-warning",D:"bg-error",E:"bg-error/dark"},getRange=(e,r)=>{if(null===e){if(null===r)throw Error("Both lower and upper bounds cannot be null");return{text:"< ".concat(r,"%"),width:r}}return null===r?{text:"> ".concat(e,"%"),width:100-e}:{text:"".concat(e,"% - ").concat(r,"%"),width:r-e}},EcoScoreSection=e=>{let{letter:r,lowerBound:l,upperBound:s,className:a}=e,c=N[r],{text:o,width:n}=getRange(l,s);return(0,t.jsxs)("div",{className:(0,f.cn)("flex h-full flex-col items-center justify-center gap-1 text-white",c,a),style:{width:"".concat(n,"%")},children:[(0,t.jsx)("p",{className:"text-base font-semibold lg:text-lg",children:r}),(0,t.jsx)("p",{className:"text-xs lg:text-base",children:o})]})},EcoScoreGraph=e=>{let{percentage:r}=e;return(0,t.jsxs)(j.x,{className:"w-full max-w-5xl",children:[(0,t.jsx)("div",{className:"h-fit w-full pb-9 pt-4 lg:pt-9",children:(0,t.jsxs)("div",{className:"relative flex h-16 w-full rounded-md lg:h-20 lg:min-w-[600px]",children:[b.map((e,r)=>(0,t.jsx)(EcoScoreSection,{...e,className:(0,f.cn)(0===r&&"rounded-l-md",r===b.length-1&&"rounded-r-md")},e.letter)),(0,t.jsx)(EcoScoreTooltip,{percentage:r})]})}),(0,t.jsx)(j.B,{orientation:"horizontal"})]})},GradingLetter=e=>{let{letter:r}=e;return(0,t.jsx)("div",{className:(0,f.cn)("flex h-16 w-16 items-center justify-center rounded-lg text-2xl font-bold text-white lg:h-20 lg:w-20 lg:min-w-[80px] lg:text-4xl",N[r]),children:r})},EcoScoreTooltip=e=>{let{percentage:r}=e,l="".concat(r.toFixed(1),"%"),s={width:10*l.length,left:"calc(".concat(r,"% - 25px)")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.RPR,{size:25,className:"absolute bottom-[-16px] text-black",style:s}),(0,t.jsx)("div",{className:"absolute bottom-[-30px]",style:s,children:(0,t.jsx)("p",{className:"rounded-sm bg-black p-1 text-center text-xs text-white",children:l})})]})};var organisms_EcoScoreCard=e=>{let{percentage:r,grade:l,campaign:s,productName:c}=e,n=(0,a.useTranslations)(),x=(0,a.useLocale)();return(0,t.jsxs)(i.Zb,{className:"h-full p-4",children:[(0,t.jsxs)("div",{className:"pb-2",children:[(0,t.jsx)(d.Z,{children:n("report.ecoScore.resultsTitle",{productName:c?"- ".concat((0,o.i)(c,x)):void 0})}),(0,t.jsx)("p",{className:"text-xs font-light text-gray/600",children:n("report.ecoScore.campaignPeriod",{...s})}),(0,t.jsx)(u.Z,{className:"mt-3 border-dashed border-gray/300"})]}),(0,t.jsxs)("div",{className:"mt-4 flex h-[calc(100%_-_60px)] w-full flex-col items-center justify-center px-10 lg:mt-0 lg:flex-row lg:gap-20",children:[(0,t.jsx)(GradingLetter,{letter:l}),(0,t.jsx)(EcoScoreGraph,{percentage:r})]})]})},v=l(3411);let w={A:"text-success/light",B:"text-success",C:"text-warning",D:"text-error",E:"text-error/dark"};var organisms_EcoScoreTable=e=>{let{tableData:r}=e,l=(0,a.useTranslations)(),c=(0,a.useLocale)();return(0,t.jsxs)("div",{className:"h-full",children:[(0,t.jsx)(d.Z,{children:l("report.ecoScore.resultsSummary")}),(0,t.jsx)(u.Z,{className:"mb-5 mt-3 border-dashed border-gray/300"}),(0,t.jsxs)("div",{className:"mb-2 grid w-full grid-cols-5 place-items-center bg-gray/100 p-2 text-sm font-semibold",children:[(0,t.jsx)("p",{children:l("report.ecoScore.table.area")}),(0,t.jsx)("p",{children:l("report.ecoScore.table.indicator")}),(0,t.jsx)("p",{children:l("report.ecoScore.table.result")}),(0,t.jsx)("p",{children:l("report.ecoScore.table.score")}),(0,t.jsx)("p",{children:l("report.ecoScore.table.previousCampaign")})]}),(0,t.jsx)(j.x,{className:"h-[calc(100%_-_100px)]",children:r.map(e=>(0,t.jsxs)(s.Fragment,{children:[(0,t.jsxs)("div",{className:"grid w-full grid-cols-5 place-items-center p-2 text-center text-sm text-gray/500",children:[(0,t.jsx)("p",{style:{gridRowStart:1,gridRowEnd:e.kpiResults.length+1},children:l("kpiCategory.".concat(e.categoryKey))}),e.kpiResults.map(e=>{var r;return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("p",{children:(0,o.i)(e.kpiName,c)}),(0,t.jsx)("p",{className:(0,f.cn)("font-medium",w[e.ecoScoreGrade]),children:"".concat((0,v.N)(e.ecoScoreValue,1,!0),"%")}),(0,t.jsx)("p",{className:(0,f.cn)("font-medium",w[e.ecoScoreGrade]),children:e.ecoScoreGrade}),(0,t.jsx)("p",{children:null!==(r=e.previousCampaignGrade)&&void 0!==r?r:"-"})]},e.kpiId)})]}),(0,t.jsx)(u.Z,{className:"my-1 border-dashed border-gray/300"})]},e.categoryKey))})]})},S=l(3197);let Shimmer=()=>{let e=(0,a.useTranslations)();return(0,t.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,t.jsx)(d.Z,{className:"font-secondary text-2xl",children:e("pageTitles.ecoScore")}),(0,t.jsxs)(i.Zb,{className:"flex h-[289px] flex-col p-4 lg:h-[245px]",children:[(0,t.jsxs)("div",{className:"pb-2",children:[(0,t.jsx)(p.O,{className:"mb-2 h-[25px] w-[250px]"}),(0,t.jsx)(p.O,{className:"h-5 w-[200px]"}),(0,t.jsx)(u.Z,{className:"mt-3 border-dashed border-gray/300"})]}),(0,t.jsx)("div",{className:"mt-4 flex h-full w-full items-center justify-center",children:(0,t.jsx)(p.O,{className:"h-20 w-full max-w-[80%]"})})]}),(0,t.jsx)("div",{className:"flex h-[calc(100vh_-_460px)] flex-col gap-2 lg:h-[calc(100vh_-_420px)]",children:(0,t.jsxs)(i.Zb,{className:"h-full p-4",children:[(0,t.jsx)(p.O,{className:"mb-2 h-[25px] w-[250px]"}),(0,t.jsx)(u.Z,{className:"mb-5 mt-3 border-dashed border-gray/300"}),(0,t.jsxs)("div",{className:"mb-2 grid w-full grid-cols-5 place-items-center bg-gray/100 p-2 text-sm font-semibold",children:[(0,t.jsx)("p",{children:e("report.ecoScore.table.area")}),(0,t.jsx)("p",{children:e("report.ecoScore.table.indicator")}),(0,t.jsx)("p",{children:e("report.ecoScore.table.result")}),(0,t.jsx)("p",{children:e("report.ecoScore.table.score")}),(0,t.jsx)("p",{children:e("report.ecoScore.table.previousCampaign")})]}),(0,t.jsx)("div",{className:"mb-2 grid w-full grid-cols-5 place-items-center p-2",children:Array.from({length:15}).map((e,r)=>(0,t.jsx)(p.O,{className:"my-2 h-7 w-2/3"},r))})]})})]})},EcoScorePage=()=>{var e,r,l,u;let p=(0,a.useTranslations)(),g=(0,a.useLocale)(),[f,j]=(0,s.useState)(),[b,N]=(0,s.useState)(),{data:v,isLoading:w}=c.h.report.productsAndCampaignsList.useQuery();(0,s.useEffect)(()=>{if(v&&!f){var e;j(null===(e=v[0])||void 0===e?void 0:e.id)}},[v]);let{data:S,isLoading:y}=c.h.report.ecoScoreData.useQuery({organizationCampaignId:f,productId:b},{enabled:!!f}),_=null==v?void 0:v.find(e=>e.id===f),E=null==_?void 0:_.products,C=null!==(l=null==E?void 0:E.length)&&void 0!==l?l:0,k=null!==(u=null==_?void 0:_.totalProducts)&&void 0!==u?u:0;return(null==E?void 0:E.length)===0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{className:"mb-4 font-secondary text-2xl",children:p("pageTitles.ecoScore")}),(0,t.jsx)("div",{className:"h-[calc(100vh_-_160px)]",children:(0,t.jsx)(h.Z,{})})]}):w||y?(0,t.jsx)(Shimmer,{}):(0,t.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-between",children:[(0,t.jsx)(d.Z,{className:"font-secondary text-2xl",children:p("pageTitles.ecoScore")}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(x.Ph,{onValueChange:e=>j(e),value:f,children:[(0,t.jsx)(x.i4,{className:"h-7 w-1/2 border-gray/500 text-xs text-gray/500 lg:w-[200px]",children:(0,t.jsx)(x.ki,{placeholder:p("report.ecoScore.selectCampaign")})}),(0,t.jsx)(x.Bw,{children:null==v?void 0:v.map(e=>(0,t.jsx)(x.Ql,{value:e.id,children:(0,t.jsxs)("p",{children:[(0,n.UW)(e.startDate,p)," - ",(0,n.UW)(e.endDate,p)]})},e.id))})]}),(0,t.jsxs)(x.Ph,{onValueChange:e=>"allProducts"===e?N(void 0):N(e),value:b,children:[(0,t.jsx)(x.i4,{className:"h-7 w-1/2 border-gray/500 text-xs text-gray/500 lg:w-[200px]",children:(0,t.jsx)(x.ki,{placeholder:p("report.ecoScore.allProducts")})}),(0,t.jsxs)(x.Bw,{children:[(0,t.jsx)(x.Ql,{value:"allProducts",children:(0,t.jsx)("p",{children:p("report.ecoScore.allProducts")})},"allProducts"),null==E?void 0:E.map(e=>(0,t.jsx)(x.Ql,{value:e.id,children:(0,t.jsx)("p",{children:(0,o.i)(e.name,g)})},e.id))]})]},b)]})]}),(null==S?void 0:S.totalEcoScore)&&_&&(0,t.jsx)(organisms_EcoScoreCard,{productName:null==E?void 0:null===(e=E.find(e=>e.id===b))||void 0===e?void 0:e.name,grade:null==S?void 0:null===(r=S.totalEcoScore)||void 0===r?void 0:r.ecoScoreGrade,percentage:S.totalEcoScore.ecoScoreValue,campaign:{startDate:(0,n.UW)(null==_?void 0:_.startDate,p),endDate:(0,n.UW)(null==_?void 0:_.endDate,p)}}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 lg:h-[calc(100vh_-_420px)]",children:[(0,t.jsx)(i.Zb,{className:"flex-1 overflow-hidden p-4",children:(null==S?void 0:S.kpiEcoScores)&&(0,t.jsx)(organisms_EcoScoreTable,{tableData:S.kpiEcoScores})}),!b&&C!==k&&(0,t.jsx)(m.Z,{text:p("report.ecoScore.informationCard",{listedProducts:C,totalProducts:k})})]})]})};EcoScorePage.getLayout=e=>(0,t.jsx)(S.Z,{children:e});var y=!0,_=EcoScorePage},3411:function(e,r,l){"use strict";l.d(r,{N:function(){return round}});let round=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return 1e6>Math.abs(e)&&Math.abs(e)>=1||0===e?e.toLocaleString("en",{minimumFractionDigits:r,maximumFractionDigits:r}):l?"< 1.0":e.toExponential(2)}}},function(e){e.O(0,[235,917,525,461,898,713,872,612,512,641,774,888,179],function(){return e(e.s=287)}),_N_E=e.O()}]);