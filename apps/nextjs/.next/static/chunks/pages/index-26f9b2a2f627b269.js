(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7314:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(9029)}])},9029:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return y},default:function(){return P}});var l=a(2322),r=a(2784),s=a(2174),o=a(3988),i=a(3022),n=a(5819),c=a(6229),d=a(428),h=a(2428),u=a(8590);let Tooltip=e=>{let{targetValue:t,value:a,label:r}=e,s=Math.round((null!=a?a:0)*100/t),o=r?Math.min((null==r?void 0:r.length)*10,60):Math.max(9*s.toLocaleString().length,40),i="calc(".concat(a/t<=2?50*a/t:100,"% - ").concat(o/2,"px)");return(0,l.jsx)("div",{className:"absolute bottom-11",style:{left:i},children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("p",{className:(0,c.cn)("line-clamp-1 bg-white p-0.5 text-center text-xs",!r&&"rounded-sm bg-gray/800 text-white"),style:{width:o},children:null!=r?r:"".concat(s,"%")}),(0,l.jsx)(n.yQg,{size:16,className:"absolute left-[calc(50%_-_8px)] top-[14px]"})]})})},BenchmarkTooltip=()=>{let e=(0,s.useTranslations)(),t=9*e("polarChart.benchmark").length;return(0,l.jsx)("div",{className:"absolute top-11",style:{left:"calc(50% - ".concat(t/2,"px)")},children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(n.RPR,{size:16,className:"absolute bottom-[18px] left-[calc(50%_-_8px)]"}),(0,l.jsx)("p",{className:"w-fit rounded-sm bg-gray/800 p-1 text-center text-xs text-white",style:{width:t},children:e("polarChart.benchmark")})]})})},KPIGradientBar=e=>{let{targetValue:t,currentValue:a,products:r}=e,s=null==r?void 0:r.filter(e=>Math.abs(e.value/t*100-a/t*100)>20),o=null==s?void 0:s.filter((e,a,l)=>{var r,s;if(0===a)return!0;let o=null!==(s=null===(r=l[a-1])||void 0===r?void 0:r.value)&&void 0!==s?s:0;return Math.abs(e.value/t*100-o/t*100)>20});return(0,l.jsxs)("div",{className:"relative w-full",children:[null==o?void 0:o.map((e,a)=>(0,l.jsx)(Tooltip,{targetValue:t,value:e.value,label:e.name},a)),(0,l.jsx)(Tooltip,{targetValue:t,value:a}),(0,l.jsx)(BenchmarkTooltip,{}),(0,l.jsx)("div",{className:"relative mb-4 mt-16 h-9 w-full rounded-full bg-gradient-green-to-red",children:["16%","33%","50%","66%","82%"].map((e,t)=>(0,l.jsx)("div",{className:"absolute h-full w-0.5 bg-white",style:{right:e}},t))})]})};var molecules_KPIDetailModal=e=>{let{selectedCategory:t,setSelectedCategory:a,kpis:o}=e,n=(0,s.useTranslations)(),[c,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{t&&m(!0)},[t]),(0,l.jsx)(d.Vq,{open:c,onOpenChange:()=>{m(!1),a(void 0)},children:(0,l.jsxs)(d.cZ,{className:"flex flex-col sm:max-w-[680px]",children:[(0,l.jsx)(d.fK,{className:"mb-8 mt-2 px-10",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(d.$N,{className:"font-medium text-secondary",children:t&&n("polarChart.categories.".concat(t))}),(0,l.jsx)(i.nfZ,{onClick:()=>{m(!1),a(void 0)},size:16,className:"cursor-pointer p-0"})]})}),(0,l.jsx)(u.Z,{}),(0,l.jsx)(h.x,{children:(0,l.jsx)("div",{className:"h-full max-h-[60vh] px-10 py-6",children:(0,l.jsx)("div",{className:"flex flex-col gap-y-10",children:o.map((e,t)=>(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"mb-4 font-semibold",children:e.name}),(0,l.jsx)("p",{className:"mb-8 text-justify",children:e.description}),(0,l.jsx)(KPIGradientBar,{targetValue:e.benchmark,currentValue:e.totalValue,products:e.products})]},t))})})})]})})},m=a(4468),f=a(6881),g=a(3738),p=a(7687),x=a(857);let getRelativePosition=(e,t,a)=>(e/t>1?(e-t)*50/(t*(a-1))+50:50*e/t)+b,v=["EcosystemQuality","HumanHealth","ResourcesExhaustion","ClimateChange"];var hooks_usePolarChart=()=>{var e;let t=(0,s.useLocale)(),{data:a,isLoading:l}=p.h.homePage.homePageData.useQuery(),[o,i]=(0,r.useState)([]),n=null!==(e=null==a?void 0:a.logoUrl)&&void 0!==e?e:"";(0,r.useEffect)(()=>{if(a){let e=a.homePageData.map(e=>({...e,name:(0,x.i)(e.name,t),description:(0,x.i)(e.description,t),products:e.products.map(e=>({...e,name:(0,x.i)(e.name,t)}))}));i(e)}},[a,t]);let c=Math.max(Math.max(...o.map(e=>e.totalValue/e.benchmark<=1?1:e.totalValue/e.benchmark)),2),d={};v.map((e,t)=>{let a=o.filter(t=>t.category===e),l=Array(4*a.length).fill(void 0);null==a||a.map((e,r)=>{l[r+a.length*t]=e}),d[e]=l});let h={datasets:v.map(e=>({data:d[e].map(e=>e?getRelativePosition(e.totalValue,e.benchmark,c):0),label:d[e].map(e=>{var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""})}))},u=l||!a;return{polarChartData:h,kpis:o,logoUrl:n,isLoading:u}};m.kL.register(m.l7,m.qi,f.Z);let b=20,createRadialGradient=(e,t,a,l)=>{let r=e.chartArea.width/2,s=e.chartArea.height/2,o=e.width/2*((100+b)/200),i=e.ctx,n=i.createRadialGradient(r,s,0,r,s,o);return n.addColorStop(b/(100+b),t),n.addColorStop((50+b)/(100+b),a),n.addColorStop(1,l),n},w={id:"angleLines",afterDatasetDraw:e=>{let{ctx:t}=e,a=e.data.datasets.map(e=>e.data.length/4),getAngles=(e,t)=>{let a=90/e,l=[];for(let r=1;r<=e;r++)l.push((a*r+t)*(Math.PI/180));return l},l=[Math.PI/2,Math.PI,3*Math.PI/2,2*Math.PI];a.map((e,t)=>{let a=getAngles(e,(t+1)*90);l.push(...a)});let r=e.chartArea.width/2,s=e.chartArea.height/2,o=e.width/2*(100+b)/200;l.map(e=>{let a=r-o*Math.cos(e),l=s-o*Math.sin(e);t.save(),t.beginPath(),t.moveTo(r,s),t.lineTo(a,l),t.lineWidth=1.5,t.strokeStyle="#fff",t.stroke(),t.closePath()}),t.save(),t.beginPath(),t.lineWidth=1.5,t.strokeStyle="#fff",t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowBlur=30,t.shadowColor="#c4cdd5",t.arc(r,s,o,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.restore()}},thresholdLines=e=>({id:"thresholdLines",afterDatasetDraw:t=>{let{ctx:a}=t,l=t.chartArea.width/2,r=t.chartArea.height/2,s=t.width/2*(50+b)/200;a.save(),a.beginPath(),a.lineWidth=1.5,a.strokeStyle="#8e33ff",a.setLineDash([5,5]),a.arc(l,r,s,0,2*Math.PI,!1),a.stroke(),a.font="10pt Poppins",a.textAlign="center",a.fillStyle="#8e33ff",Array.from(e).map((e,t)=>{let o=(t-15)*4.5;a.save(),a.translate(l+(s+5)*Math.cos((o-90)*(Math.PI/180)),r+(s+5)*Math.sin((o-90)*(Math.PI/180))),a.rotate(o*(Math.PI/180)),a.fillText(e,0,0),a.restore()}),a.closePath(),a.restore()}}),centerImage=(e,t)=>({id:"centerImage",afterDatasetDraw:a=>{let{ctx:l}=a,r=a.chartArea.width/2,s=a.chartArea.height/2,o=a.width/2*b/200;l.save(),l.beginPath(),l.arc(r,s,o,0,2*Math.PI,!1),l.fillStyle="#ffffff",l.fill(),l.clip();let imageProperties=e=>{let t,a;let l=Math.min(e.width,e.height),i=Math.max(e.width,e.height),n=2*o-(l!==i?15*i/l:0);e.width>e.height?(t=n,a=e.height*n/e.width):(a=n,t=e.width*n/e.height);let c=r-t/2,d=s-a/2;return{dx:c,dy:d,imageWidth:t,imageHeight:a}};try{let{dx:t,dy:a,imageWidth:r,imageHeight:s}=imageProperties(e);l.drawImage(e,t,a,r,s)}catch(o){let{dx:e,dy:a,imageWidth:r,imageHeight:s}=imageProperties(t);l.drawImage(t,e,a,r,s)}l.closePath(),l.restore()}});var organisms_PolarAreaChart=e=>{let{chartData:t,setSelectedCategory:a,logoUrl:o}=e,i=(0,s.useTranslations)(),[n,d]=(0,r.useState)(),h=new Image;h.src=o.length>0?o:"/icons/logoBlackLetters.svg";let u=new Image;return u.src="/icons/logoBlackLetters.svg",(0,l.jsxs)("div",{style:{cursor:n?"pointer":"default"},className:"relative flex h-full max-h-[900px] w-full max-w-[900px] items-center justify-center overflow-hidden xl:w-[70%]",children:[v.map(e=>(0,l.jsx)("p",{className:(0,c.cn)("absolute whitespace-pre-line font-bold",n===e?"text-secondary":n&&"text-gray/400","ClimateChange"===e&&"left-0 top-40 lg:top-10","EcosystemQuality"===e&&"right-0 top-40 text-right lg:top-10","HumanHealth"===e&&"bottom-40 right-0 text-right lg:bottom-5","ResourcesExhaustion"===e&&"bottom-40 left-0 lg:bottom-5"),children:i("polarChart.categories.".concat(e))},e)),(0,l.jsx)("div",{className:"flex aspect-square w-full items-center justify-center lg:h-[115%] lg:w-[unset]",children:(0,l.jsx)(g.xz,{data:t,options:{animation:{animateRotate:!1,animateScale:!1},onClick(e,t){var l;let r=null===(l=t[0])||void 0===l?void 0:l.datasetIndex;void 0!==r&&a(v[r])},onHover:(e,t,a)=>{var l;let r=a.config.data.datasets,s=null===(l=t[0])||void 0===l?void 0:l.datasetIndex,o=void 0===n&&void 0===s||void 0!==s&&n===v[s];o||(t.length>0&&void 0!==s?(d(v[s]),r.forEach((e,t)=>{s===t?e.backgroundColor=createRadialGradient(a,"#14AE5C","#ffcd29","#FF5630"):e.backgroundColor=createRadialGradient(a,"#14ae5c81","#ffcd2981","#FF563081")})):(d(void 0),r.forEach(e=>e.backgroundColor=createRadialGradient(a,"#14AE5C","#ffcd29","#FF5630"))),a.update("none"))},elements:{arc:{backgroundColor:e=>createRadialGradient(e.chart,"#14AE5C","#ffcd29","#FF5630"),hoverBorderColor:"transparent",borderColor:"transparent"}},plugins:{tooltip:{enabled:!1},datalabels:{textAlign:"center",color:e=>{if(n){let t=v.indexOf(n),a=e.datasetIndex===t?"#8e33ff":"#c4cdd5";return a}return"#454f5b"},anchor:"end",align:"end",clip:!0,font:{family:"Poppins",size:12},offset:e=>{let t=e.dataset.data[e.dataIndex];return"number"!=typeof t&&(t=0),(100+b-t)*(e.chart.width/2)/200+10},formatter:(e,t)=>{var a,l,r;return null===(r=t.dataset)||void 0===r?void 0:null===(l=r.label)||void 0===l?void 0:null===(a=l[t.dataIndex])||void 0===a?void 0:a.split(/[\s-]+/)}}},scales:{r:{ticks:{display:!1},grid:{display:!1},max:200}}},plugins:[w,thresholdLines(i("polarChart.benchmark")),centerImage(h,u)]},o?"logoLoaded":"logoNotLoaded")})]})},j=a(3197);let Home=()=>{let{polarChartData:e,kpis:t,logoUrl:a,isLoading:i}=hooks_usePolarChart(),n=(0,s.useLocale)(),c="polar-chart-".concat(n),[d,h]=(0,r.useState)();return i?(0,l.jsx)("div",{className:"flex h-[calc(100vh_-_180px)] w-full items-center justify-center",children:(0,l.jsx)(o.Cd,{size:120,className:"animate-spin text-gray/400"})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(molecules_KPIDetailModal,{kpis:null==t?void 0:t.filter(e=>e.category===d),selectedCategory:d,setSelectedCategory:h}),(0,l.jsx)("div",{className:"flex h-[calc(100vh_-_150px)] w-full justify-center",children:(0,l.jsx)(organisms_PolarAreaChart,{chartData:e,setSelectedCategory:h,logoUrl:a},c)})]})};Home.getLayout=e=>(0,l.jsx)(j.Z,{userName:e.props.userName,titleKey:"home",children:e});var y=!0,P=Home}},function(e){e.O(0,[235,917,525,461,898,713,872,767,278,935,612,512,965,784,641,774,888,179],function(){return e(e.s=7314)}),_N_E=e.O()}]);